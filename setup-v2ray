#/bin/bash
apt-get update -y
apt-get upgrade -y
apt-get install zip -y
#INSTALL xray
wget https://raw.githubusercontent.com/berkasaink/convig-vps/main/xray.sh && chmod +x xray.sh && bash xray.sh
rm xray.sh
wget -O /usr/bin/exp-vmess https://www.dropbox.com/s/hubzo80uz9w6x4s/exp-vmess
chmod +x /usr/bin/exp-vmess
systemctl stop xray
systemctl stop nginx
#INSTALL TROJAN-GO
wget -O trojan-go.sh https://www.dropbox.com/s/21enfxh5w47jaos/ojan.sh && chmod +x trojan-go.sh && bash trojan-go.sh
rm trojan-go.sh
wget -O /usr/bin/exptrojan https://www.dropbox.com/s/f45fx54v4df8m4c/exptrojan-go
chmod +x /usr/bin/exptrojan
wget -O /usr/bin/reload_vps https://github.com/berkasaink/convig-vps/raw/main/reload_vps
chmod +x /usr/bin/reload_vps
sed -i '$ i\0 */6 * * * root /usr/bin/reload_vps' /etc/crontab
## RC LOCAL
wget -O /usr/bin/badvpn-udpgw "https://github.com/zahwanugrah/AutoScriptSSH/raw/main/badvpn-udpgw64"
chmod +x /usr/bin/badvpn-udpgw
local.service
cat > /etc/systemd/system/rc-local.service <<-END
[Unit]
Description=/etc/rc.local
ConditionPathExists=/etc/rc.local
[Service]
Type=forking
ExecStart=/etc/rc.local start
TimeoutSec=0
StandardOutput=tty
RemainAfterExit=yes
SysVStartPriority=99
[Install]
WantedBy=multi-user.target
END
cat > /etc/rc.local <<-END
#!/bin/sh -e
# rc.local
# By default this script does nothing.
screen -dmS badvpn badvpn-udpgw --listen-addr 127.0.0.1:7300 --max-clients 500
exit 0
END
chmod +x /etc/rc.local
systemctl enable rc-local
systemctl start rc-local.service
echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6
sed -i '$ i\echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6' /etc/rc.local
## config v2ray
rm -rf /usr/local/etc/xray/*
rm -rf /usr/local/etc/trojan/*
rm -rf /etc/nginx/conf.d/*
wget -O /usr/local/etc/xray/config.json https://github.com/berkasaink/convig-vps/raw/main/config-xray.json
wget -O /usr/local/etc/trojan/config.json https://github.com/berkasaink/convig-vps/raw/main/ojan-go.json
wget -O /etc/nginx/conf.d/xray.conf https://github.com/berkasaink/convig-vps/raw/main/xray.conf
## SERTIFIKAT
mkdir -p /etc/GoenkTea
wget -O /etc/GoenkTea/cert.pem https://github.com/berkasaink/sertifikat/raw/main/cert.pem
wget -O /etc/GoenkTea/key.pem https://github.com/berkasaink/sertifikat/raw/main/key.pem
## menu v2ray
wget -O /usr/bin/trojan-add "https://github.com/berkasaink/menu/raw/main/trojan-add"
chmod +x /usr/bin/trojan-add
wget -O /usr/bin/trojan-delete "https://github.com/berkasaink/menu/raw/main/trojan-delete"
chmod +x /usr/bin/trojan-delete
wget -O /usr/bin/trojan-expired "https://github.com/berkasaink/menu/raw/main/trojan-expired"
chmod +x /usr/bin/trojan-expired
wget -O /usr/bin/trojan-expired-soon "https://github.com/berkasaink/menu/raw/main/trojan-expired-soon"
chmod +x /usr/bin/trojan-expired-soon
wget -O /usr/bin/trojan-list "https://github.com/berkasaink/menu/raw/main/trojan-list"
chmod +x /usr/bin/trojan-list
wget -O /usr/bin/v2ray-add "https://github.com/berkasaink/menu/raw/main/v2ray-add"
chmod +x /usr/bin/v2ray-add
wget -O /usr/bin/v2ray-delete "https://github.com/berkasaink/menu/raw/main/v2ray-delete"
chmod +x /usr/bin/v2ray-delete
wget -O /usr/bin/v2ray-expired "https://github.com/berkasaink/menu/raw/main/v2ray-expired"
chmod +x /usr/bin/v2ray-expired
wget -O /usr/bin/menu "https://github.com/berkasaink/menu/raw/main/menu"
chmod +x /usr/bin/menu
wget -O /usr/bin/menu-trojan "https://github.com/berkasaink/menu/raw/main/menu-trojan"
chmod +x /usr/bin/menu-trojan
wget -O /usr/bin/menu-v2ray "https://github.com/berkasaink/menu/raw/main/menu-v2ray"
chmod +x /usr/bin/menu-v2ray
wget -O /usr/bin/clean-cache "https://github.com/berkasaink/convig-vps/raw/main/clean-cache"
chmod +x /usr/bin/clean-cache
wget -O /usr/bin/kernel-fix "https://github.com/berkasaink/convig-vps/raw/main/kernel-fix"
chmod +x /usr/bin/kernel-fix
wget -O /usr/bin/menu-reboot "https://github.com/berkasaink/convig-vps/raw/main/menu-reboot"
chmod +x /usr/bin/menu-reboot
wget -O /usr/bin/ram "https://github.com/berkasaink/convig-vps/raw/main/ram"
chmod +x /usr/bin/ram
wget -O /usr/bin/speedtest "https://github.com/berkasaink/convig-vps/raw/main/speedtest"
chmod +x /usr/bin/speedtest
wget -O /usr/bin/top "https://github.com/berkasaink/convig-vps/raw/main/top"
chmod +x /usr/bin/top
